var PlayerMovementController=pc.createScript("playerMovementController");PlayerMovementController.attributes.add("bodyEntity",{type:"entity"}),PlayerMovementController.attributes.add("moveSpeed",{type:"number",default:6}),PlayerMovementController.attributes.add("jumpHeight",{type:"number",default:13}),PlayerMovementController.attributes.add("rotateSpeed",{type:"number",default:5}),PlayerMovementController.attributes.add("nicknameText",{type:"entity"}),PlayerMovementController.prototype.initialize=function(){this.nicknameText.element.text=Utils.getRandomNickname(),this.cameraEntity=this.app.root.findByName("Camera"),this._inputVector=new pc.Vec3,this._contactNormal=new pc.Vec3,this._quat=new pc.Quat,this.canMove=!0,this._desiredAngle=0,this._desiredJump=!1,this._timeSinceLastJump=0,this._timeSinceLastGrounded=0,this.lastSentAnimation=0,this._animComponent=this.entity.findComponent("anim"),this._camera=this.entity.script.playerCameraController,this.app.root.on("gamePause",(()=>{this.canMove=!1,this._camera.mouseLocked=!1,this._inputVector.set(0,0,0),this._desiredJump=!1,this.entity.rigidbody.linearVelocity=pc.Vec3.ZERO,this.entity.rigidbody.angularVelocity=pc.Vec3.ZERO}),this),this.app.root.on("gameResume",(()=>{this.canMove=!0,this._camera.mouseLocked=!0}),this)},PlayerMovementController.prototype.update=function(t){if(this.app.root.findByName("UI").script.uiManager.onUI)return;if(this._inputVector.set(0,0,0),this._desiredJump=!1,!this.canMove)return;this._timeSinceLastJump+=t,this._timeSinceLastGrounded+=t;const e=this.app.keyboard,i=this.cameraEntity.forward;i.y=0,i.normalize();const n=this.cameraEntity.right;n.y=0,n.normalize();let s=new pc.Vec3;(e.isPressed(pc.KEY_W)||e.isPressed(pc.KEY_UP))&&this._inputVector.add(i),(e.isPressed(pc.KEY_S)||e.isPressed(pc.KEY_DOWN))&&this._inputVector.sub(i),(e.isPressed(pc.KEY_A)||e.isPressed(pc.KEY_LEFT))&&this._inputVector.sub(n),(e.isPressed(pc.KEY_D)||e.isPressed(pc.KEY_RIGHT))&&this._inputVector.add(n),e.isPressed(pc.KEY_SPACE)&&(this._desiredJump=!0),this._inputVector.normalize();const o=this.entity.getPosition().clone(),a=o.clone().sub(new pc.Vec3(0,1.25,0)),r=this.app.systems.rigidbody.raycastFirst(o,a);r&&r.entity.tags.has("Ground")?(this._contactNormal=r.normal.clone(),this._timeSinceLastGrounded=0,this._timeSinceLastJump>=.3&&(this._jumped=!1)):this._contactNormal=new pc.Vec3(0,1,0),s=this._inputVector.clone().mulScalar(this.moveSpeed),s.length()>0&&(this._desiredAngle=Math.atan2(this._inputVector.x,this._inputVector.z)*pc.math.RAD_TO_DEG,this._quat=(new pc.Quat).slerp(this._quat,(new pc.Quat).setFromEulerAngles(0,this._desiredAngle,0),this.rotateSpeed*t),this.bodyEntity.setRotation(this._quat)),s.y+=this.entity.rigidbody.linearVelocity.y;const c=s.length(),l=s.clone().normalize().dot(this._contactNormal);l>0&&!this._jumped&&s.sub(this._contactNormal.clone().mulScalar(l*c)),this._desiredJump&&this._timeSinceLastGrounded<=.3&&!this._jumped&&(this._jumped=!0,this._timeSinceLastJump=0,s.add(this._contactNormal.clone().mulScalar(this.jumpHeight)),this.entity.sound.play("Jump")),s.set(s.x,s.y-30*t,s.z),this.entity.rigidbody.linearVelocity=s,this.controlAnimation(r)},PlayerMovementController.prototype.controlAnimation=function(t){t&&t.entity.tags.has("Ground")?0!=this._inputVector.x||0!=this._inputVector.y||0!=this._inputVector.z?this.setAnimation("walk"):this.setAnimation("idle"):this.setAnimation("fall")},PlayerMovementController.prototype.setAnimation=function(t){let e=0;switch(t){case"idle":e=0;break;case"walk":e=1;break;case"fall":e=2}this._animComponent.setInteger("animIndex",e)};var PlayerCameraController=pc.createScript("playerCameraController");PlayerCameraController.attributes.add("sensitivity",{type:"number",default:.2}),PlayerCameraController.attributes.add("targetEntity",{type:"entity"}),PlayerCameraController.prototype.initialize=function(){this.cameraEntity=this.app.root.findByName("Camera"),this._eulers=new pc.Vec3,this.distance=10,this.mouseLocked=!1,this.app.mouseScroll=10,this.app.mouse.on(pc.EVENT_MOUSEDOWN,(()=>{this.app.root.findByName("UI").script.uiManager.onUI||this.app.mouse.enablePointerLock((()=>{this.mouseLocked=!0,this.app.root.findByName("UI").script.uiManager.firstClick=!0}))}),this),this.app.mouse.on(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.on(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this),this.once("destroy",(()=>{this.app.mouse.off(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.off(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this),this.app.mouse.off(pc.EVENT_MOUSEDOWN,this.onMouseDown,this)}),this)},PlayerCameraController.prototype.onMouseWheel=function(t){this.app.root.findByName("UI").script.uiManager.onUI||(this.app.mouseScroll+=t.wheelDelta,this.app.mouseScroll<5&&(this.app.mouseScroll=5),this.app.mouseScroll>30&&(this.app.mouseScroll=30))},PlayerCameraController.prototype.onMouseMove=function(t){this.app.root.findByName("UI").script.uiManager.onUI||this.mouseLocked&&(this._eulers.y-=t.dx*this.sensitivity,this._eulers.x-=t.dy*this.sensitivity,this._eulers.x=pc.math.clamp(this._eulers.x,-90,90))},PlayerCameraController.prototype.postUpdate=function(t){if(this.distance=pc.math.lerp(this.distance,this.app.mouseScroll,10*t),!this.targetEntity)return;const e=this.targetEntity.getPosition(),o=this._eulers,s=new pc.Quat;o.x=pc.math.clamp(o.x,-89,89),o.z=pc.math.clamp(o.y,-89,89),s.setFromEulerAngles(o.x,o.y,0);const i=s.transformVector(new pc.Vec3(0,0,this.distance),new pc.Vec3),a=e.clone().add(i);this.cameraEntity.setPosition(a),this.cameraEntity.lookAt(e)};var StartTrigger=pc.createScript("startTrigger");StartTrigger.prototype.initialize=function(){if(this._stage=this.entity.parent.parent,this._checkpointIndex=this._stage.parent.children.indexOf(this._stage),this._flagPivot=this._stage.findByName("Flag").findByName("Flag Pivot"),this._particles=this._stage.findByName("Particle System"),null!=SaveSystem.getItem("stage")&&"true"==JSON.parse(SaveSystem.getItem("stage"))[this._checkpointIndex]){let t=this._flagPivot.children[0],e=pc.Color.GREEN;return t.render.meshInstances[0].setParameter("material_diffuse",[e.r,e.g,e.b]),this._flagPivot.setLocalPosition(0,420,0),void this._flagPivot.setLocalEulerAngles(0,0,0)}this.entity.collision.on("triggerenter",this.onTriggerEnter,this)},StartTrigger.prototype.onTriggerEnter=function(t){t.tags.has("player")&&t.script.playerMovementController.canMove&&(this.app.root.stage>=this._checkpointIndex||this.newCheckpoint())},StartTrigger.prototype.newCheckpoint=function(){this.app.root.stage=this._checkpointIndex,99==this._checkpointIndex&&this.app.root.fire("finish"),this._stage.sound.play("Slot 1");let t=this._flagPivot.children[0],e=pc.Color.RED,i=pc.Color.GREEN;this.tweenedProperties={color:e.clone()},this.app.tween(this.tweenedProperties.color).to(i,1,pc.SineOut).onUpdate((()=>{t.render.meshInstances[0].setParameter("material_diffuse",[this.tweenedProperties.color.r,this.tweenedProperties.color.g,this.tweenedProperties.color.b])})).start(),this._flagPivot.tween(this._flagPivot.getLocalPosition()).to({x:0,y:420,z:0},1,pc.SineOut).start(),this._flagPivot.tween(this._flagPivot.getLocalEulerAngles()).rotate(new pc.Vec3(0,0,0),1,pc.SineOut).start(),this._playParticleEffect(this._particles);let r=JSON.parse(SaveSystem.getItem("stage"));r[this._checkpointIndex]="true",SaveSystem.setItem("stage",JSON.stringify(r)),this.app.root.fire("stageUpdate",this._checkpointIndex)},StartTrigger.prototype._playParticleEffect=function(t){for(var e=t.children,i=0;i<e.length;i++)e[i].particlesystem.reset(),e[i].particlesystem.play()};pc.extend(pc,function(){var TweenManager=function(t){this._app=t,this._tweens=[],this._add=[]};TweenManager.prototype={add:function(t){return this._add.push(t),t},update:function(t){for(var i=0,e=this._tweens.length;i<e;)this._tweens[i].update(t)?i++:(this._tweens.splice(i,1),e--);if(this._add.length){for(let t=0;t<this._add.length;t++)this._tweens.indexOf(this._add[t])>-1||this._tweens.push(this._add[t]);this._add.length=0}}};var Tween=function(t,i,e){pc.events.attach(this),this.manager=i,e&&(this.entity=null),this.time=0,this.complete=!1,this.playing=!1,this.stopped=!0,this.pending=!1,this.target=t,this.duration=0,this._currentDelay=0,this.timeScale=1,this._reverse=!1,this._delay=0,this._yoyo=!1,this._count=0,this._numRepeats=0,this._repeatDelay=0,this._from=!1,this._slerp=!1,this._fromQuat=new pc.Quat,this._toQuat=new pc.Quat,this._quat=new pc.Quat,this.easing=pc.Linear,this._sv={},this._ev={}},_parseProperties=function(t){var i;return t instanceof pc.Vec2?i={x:t.x,y:t.y}:t instanceof pc.Vec3?i={x:t.x,y:t.y,z:t.z}:t instanceof pc.Vec4||t instanceof pc.Quat?i={x:t.x,y:t.y,z:t.z,w:t.w}:t instanceof pc.Color?(i={r:t.r,g:t.g,b:t.b},void 0!==t.a&&(i.a=t.a)):i=t,i};Tween.prototype={to:function(t,i,e,s,n,r){return this._properties=_parseProperties(t),this.duration=i,e&&(this.easing=e),s&&this.delay(s),n&&this.repeat(n),r&&this.yoyo(r),this},from:function(t,i,e,s,n,r){return this._properties=_parseProperties(t),this.duration=i,e&&(this.easing=e),s&&this.delay(s),n&&this.repeat(n),r&&this.yoyo(r),this._from=!0,this},rotate:function(t,i,e,s,n,r){return this._properties=_parseProperties(t),this.duration=i,e&&(this.easing=e),s&&this.delay(s),n&&this.repeat(n),r&&this.yoyo(r),this._slerp=!0,this},start:function(){var t,i,e,s;if(this.playing=!0,this.complete=!1,this.stopped=!1,this._count=0,this.pending=this._delay>0,this._reverse&&!this.pending?this.time=this.duration:this.time=0,this._from){for(t in this._properties)this._properties.hasOwnProperty(t)&&(this._sv[t]=this._properties[t],this._ev[t]=this.target[t]);this._slerp&&(this._toQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z),i=void 0!==this._properties.x?this._properties.x:this.target.x,e=void 0!==this._properties.y?this._properties.y:this.target.y,s=void 0!==this._properties.z?this._properties.z:this.target.z,this._fromQuat.setFromEulerAngles(i,e,s))}else{for(t in this._properties)this._properties.hasOwnProperty(t)&&(this._sv[t]=this.target[t],this._ev[t]=this._properties[t]);this._slerp&&(i=void 0!==this._properties.x?this._properties.x:this.target.x,e=void 0!==this._properties.y?this._properties.y:this.target.y,s=void 0!==this._properties.z?this._properties.z:this.target.z,void 0!==this._properties.w?(this._fromQuat.copy(this.target),this._toQuat.set(i,e,s,this._properties.w)):(this._fromQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z),this._toQuat.setFromEulerAngles(i,e,s)))}return this._currentDelay=this._delay,this.manager.add(this),this},pause:function(){this.playing=!1},resume:function(){this.playing=!0},stop:function(){this.playing=!1,this.stopped=!0},delay:function(t){return this._delay=t,this.pending=!0,this},repeat:function(t,i){return this._count=0,this._numRepeats=t,this._repeatDelay=i||0,this},loop:function(t){return t?(this._count=0,this._numRepeats=1/0):this._numRepeats=0,this},yoyo:function(t){return this._yoyo=t,this},reverse:function(){return this._reverse=!this._reverse,this},chain:function(){for(var t=arguments.length;t--;)t>0?arguments[t-1]._chained=arguments[t]:this._chained=arguments[t];return this},onUpdate:function(t){return this.on("update",t),this},onComplete:function(t){return this.on("complete",t),this},onLoop:function(t){return this.on("loop",t),this},update:function(t){if(this.stopped)return!1;if(!this.playing)return!0;if(!this._reverse||this.pending?this.time+=t*this.timeScale:this.time-=t*this.timeScale,this.pending){if(!(this.time>this._currentDelay))return!0;this._reverse?this.time=this.duration-(this.time-this._currentDelay):this.time-=this._currentDelay,this.pending=!1}var i=0;(!this._reverse&&this.time>this.duration||this._reverse&&this.time<0)&&(this._count++,this.complete=!0,this.playing=!1,this._reverse?(i=this.duration-this.time,this.time=0):(i=this.time-this.duration,this.time=this.duration));var e,s,n=0===this.duration?1:this.time/this.duration,r=this.easing(n);for(var h in this._properties)this._properties.hasOwnProperty(h)&&(e=this._sv[h],s=this._ev[h],this.target[h]=e+(s-e)*r);if(this._slerp&&this._quat.slerp(this._fromQuat,this._toQuat,r),this.entity&&(this.entity._dirtifyLocal(),this.element&&this.entity.element&&(this.entity.element[this.element]=this.target),this._slerp&&this.entity.setLocalRotation(this._quat)),this.fire("update",t),this.complete){var a=this._repeat(i);return a?this.fire("loop"):(this.fire("complete",i),this.entity&&this.entity.off("destroy",this.stop,this),this._chained&&this._chained.start()),a}return!0},_repeat:function(t){if(this._count<this._numRepeats){if(this._reverse?this.time=this.duration-t:this.time=t,this.complete=!1,this.playing=!0,this._currentDelay=this._repeatDelay,this.pending=!0,this._yoyo){for(var i in this._properties){var e=this._sv[i];this._sv[i]=this._ev[i],this._ev[i]=e}this._slerp&&(this._quat.copy(this._fromQuat),this._fromQuat.copy(this._toQuat),this._toQuat.copy(this._quat))}return!0}return!1}};var BounceOut=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},BounceIn=function(t){return 1-BounceOut(1-t)};return{TweenManager:TweenManager,Tween:Tween,Linear:function(t){return t},QuadraticIn:function(t){return t*t},QuadraticOut:function(t){return t*(2-t)},QuadraticInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},CubicIn:function(t){return t*t*t},CubicOut:function(t){return--t*t*t+1},CubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},QuarticIn:function(t){return t*t*t*t},QuarticOut:function(t){return 1- --t*t*t*t},QuarticInOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},QuinticIn:function(t){return t*t*t*t*t},QuinticOut:function(t){return--t*t*t*t*t+1},QuinticInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},SineIn:function(t){return 0===t?0:1===t?1:1-Math.cos(t*Math.PI/2)},SineOut:function(t){return 0===t?0:1===t?1:Math.sin(t*Math.PI/2)},SineInOut:function(t){return 0===t?0:1===t?1:.5*(1-Math.cos(Math.PI*t))},ExponentialIn:function(t){return 0===t?0:Math.pow(1024,t-1)},ExponentialOut:function(t){return 1===t?1:1-Math.pow(2,-10*t)},ExponentialInOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))},CircularIn:function(t){return 1-Math.sqrt(1-t*t)},CircularOut:function(t){return Math.sqrt(1- --t*t)},CircularInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},BackIn:function(t){var i=1.70158;return t*t*((i+1)*t-i)},BackOut:function(t){var i=1.70158;return--t*t*((i+1)*t+i)+1},BackInOut:function(t){var i=2.5949095;return(t*=2)<1?t*t*((i+1)*t-i)*.5:.5*((t-=2)*t*((i+1)*t+i)+2)},BounceIn:BounceIn,BounceOut:BounceOut,BounceInOut:function(t){return t<.5?.5*BounceIn(2*t):.5*BounceOut(2*t-1)+.5},ElasticIn:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),-e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/.4))},ElasticOut:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),e*Math.pow(2,-10*t)*Math.sin((t-i)*(2*Math.PI)/.4)+1)},ElasticInOut:function(t){var i,e=.1,s=.4;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=s*Math.asin(1/e)/(2*Math.PI),(t*=2)<1?e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/s)*-.5:e*Math.pow(2,-10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/s)*.5+1)}}}()),function(){pc.AppBase.prototype.addTweenManager=function(){this._tweenManager=new pc.TweenManager(this),this.on("update",(function(t){this._tweenManager.update(t)}))},pc.AppBase.prototype.tween=function(t){return new pc.Tween(t,this._tweenManager)},pc.Entity.prototype.tween=function(t,i){var e=this._app.tween(t);return e.entity=this,this.once("destroy",e.stop,e),i&&i.element&&(e.element=i.element),e};var t=pc.AppBase.getApplication();t&&t.addTweenManager()}();var PlayerDeathController=pc.createScript("playerDeathController");PlayerDeathController.prototype.initialize=function(){if(this.entity.collision.on("collisionstart",this.onCollisionStart,this),this._movement=this.entity.script.playerMovementController,this._camera=this.entity.script.playerCameraController,this.app.root.on("respawn",this._onRespawn,this),this.app.root.on("skipStage",this._onSkipStage,this),null==this.app.root.stage)return;let t=this.app.root.findByName("Map").findByName("Stages").children[this.app.root.stage].getPosition();this._spawnPos=new pc.Vec3(t.x,t.y+2,t.z),this.entity.rigidbody.teleport(this._spawnPos,pc.Vec3.ZERO)},PlayerDeathController.prototype.update=function(){this.app.root.findByName("UI").script.uiManager.onUI||this.app.keyboard.wasPressed(pc.KEY_R)&&this._onDeath()},PlayerDeathController.prototype.onCollisionStart=function(t){t.other.tags.has("Death")&&this._onDeath()},PlayerDeathController.prototype._onDeath=function(){let t=this.app.root.findByName("Map").findByName("Stages").children[this.app.root.stage].getPosition();this._spawnPos=new pc.Vec3(t.x,t.y+2,t.z),this._movement.canMove=!1,this._camera.mouseLocked=!1,this._movement._inputVector.set(0,0,0),this.entity.rigidbody.linearVelocity=pc.Vec3.ZERO,this.entity.rigidbody.angularVelocity=pc.Vec3.ZERO,this.app.root.fire("death")},PlayerDeathController.prototype._onRespawn=function(){this.entity.rigidbody.teleport(this._spawnPos,pc.Vec3.ZERO),this._movement.canMove=!0,this._camera.mouseLocked=!0},PlayerDeathController.prototype._onSkipStage=function(){if(99==this.app.root.stage)return void this.app.root.fire("respawn");let t=this.app.root.findByName("Map").findByName("Stages").children[this.app.root.stage+1].getPosition();this._spawnPos=new pc.Vec3(t.x,t.y+2,t.z),this.app.root.fire("respawn")};"undefined"!=typeof document&&(
/*! FPSMeter 0.3.1 - 9th May 2013 | https://github.com/Darsain/fpsmeter */
function(t,e){function s(t,e){for(var n in e)try{t.style[n]=e[n]}catch(t){}return t}function H(t){return null==t?String(t):"object"==typeof t||"function"==typeof t?Object.prototype.toString.call(t).match(/\s([a-z]+)/i)[1].toLowerCase()||"object":typeof t}function R(t,e){if("array"!==H(e))return-1;if(e.indexOf)return e.indexOf(t);for(var n=0,o=e.length;n<o;n++)if(e[n]===t)return n;return-1}function I(){var t,e=arguments;for(t in e[1])if(e[1].hasOwnProperty(t))switch(H(e[1][t])){case"object":e[0][t]=I({},e[0][t],e[1][t]);break;case"array":e[0][t]=e[1][t].slice(0);break;default:e[0][t]=e[1][t]}return 2<e.length?I.apply(null,[e[0]].concat(Array.prototype.slice.call(e,2))):e[0]}function N(t){return 1===(t=Math.round(255*t).toString(16)).length?"0"+t:t}function S(t,e,n,o){t.addEventListener?t[o?"removeEventListener":"addEventListener"](e,n,!1):t.attachEvent&&t[o?"detachEvent":"attachEvent"]("on"+e,n)}function D(t,e){function g(t,e,n,o){return h[0|t][Math.round(Math.min((e-n)/(o-n)*M,M))]}function r(){F.legend.fps!==q&&(F.legend.fps=q,F.legend[c]=q?"FPS":"ms"),b=q?v.fps:v.duration,F.count[c]=999<b?"999+":b.toFixed(99<b?0:O.decimals)}function m(){for(l=n(),P<l-O.threshold&&(v.fps-=v.fps/Math.max(1,60*O.smoothing/O.interval),v.duration=1e3/v.fps),w=O.history;w--;)T[w]=0===w?v.fps:T[w-1],j[w]=0===w?v.duration:j[w-1];if(r(),O.heat){if(z.length)for(w=z.length;w--;)z[w].el.style[o[z[w].name].heatOn]=q?g(o[z[w].name].heatmap,v.fps,0,O.maxFps):g(o[z[w].name].heatmap,v.duration,O.threshold,0);if(F.graph&&o.column.heatOn)for(w=C.length;w--;)C[w].style[o.column.heatOn]=q?g(o.column.heatmap,T[w],0,O.maxFps):g(o.column.heatmap,j[w],O.threshold,0)}if(F.graph)for(y=0;y<O.history;y++)C[y].style.height=(q?T[y]?Math.round(x/O.maxFps*Math.min(T[y],O.maxFps)):0:j[y]?Math.round(x/O.threshold*Math.min(j[y],O.threshold)):0)+"px"}function k(){20>O.interval?(p=i(k),m()):(p=setTimeout(k,O.interval),f=i(m))}function G(t){(t=t||window.event).preventDefault?(t.preventDefault(),t.stopPropagation()):(t.returnValue=!1,t.cancelBubble=!0),v.toggle()}function U(){O.toggleOn&&S(F.container,O.toggleOn,G,1),t.removeChild(F.container)}function V(){if(F.container&&U(),o=D.theme[O.theme],!(h=o.compiledHeatmaps||[]).length&&o.heatmaps.length){for(y=0;y<o.heatmaps.length;y++)for(h[y]=[],w=0;w<=M;w++){var e,n=h[y],a=w;e=.33/M*w;var i=o.heatmaps[y].saturation,l=o.heatmaps[y].lightness,p=void 0,c=void 0,u=void 0,d=u=void 0,f=p=c=void 0;f=void 0;0===(u=.5>=l?l*(1+i):l+i-l*i)?e="#000":(c=(u-(d=2*l-u))/u,f=(e*=6)-(p=Math.floor(e)),f*=u*c,0===p||6===p?(p=u,c=d+f,u=d):1===p?(p=u-f,c=u,u=d):2===p?(p=d,c=u,u=d+f):3===p?(p=d,c=u-f):4===p?(p=d+f,c=d):(p=u,c=d,u-=f),e="#"+N(p)+N(c)+N(u)),n[a]=e}o.compiledHeatmaps=h}for(var b in F.container=s(document.createElement("div"),o.container),F.count=F.container.appendChild(s(document.createElement("div"),o.count)),F.legend=F.container.appendChild(s(document.createElement("div"),o.legend)),F.graph=O.graph?F.container.appendChild(s(document.createElement("div"),o.graph)):0,z.length=0,F)F[b]&&o[b].heatOn&&z.push({name:b,el:F[b]});if(C.length=0,F.graph)for(F.graph.style.width=O.history*o.column.width+(O.history-1)*o.column.spacing+"px",w=0;w<O.history;w++)C[w]=F.graph.appendChild(s(document.createElement("div"),o.column)),C[w].style.position="absolute",C[w].style.bottom=0,C[w].style.right=w*o.column.width+w*o.column.spacing+"px",C[w].style.width=o.column.width+"px",C[w].style.height="0px";s(F.container,O),r(),t.appendChild(F.container),F.graph&&(x=F.graph.clientHeight),O.toggleOn&&("click"===O.toggleOn&&(F.container.style.cursor="pointer"),S(F.container,O.toggleOn,G))}"object"===H(t)&&undefined===t.nodeType&&(e=t,t=document.body),t||(t=document.body);var o,h,l,p,f,x,b,w,y,v=this,O=I({},D.defaults,e||{}),F={},C=[],M=100,z=[],E=O.threshold,A=0,P=n()-E,T=[],j=[],q="fps"===O.show;v.options=O,v.fps=0,v.duration=0,v.isPaused=0,v.tickStart=function(){A=n()},v.tick=function(){l=n(),E+=(l-P-E)/O.smoothing,v.fps=1e3/E,v.duration=A<P?E:l-A,P=l},v.pause=function(){return p&&(v.isPaused=1,clearTimeout(p),a(p),a(f),p=f=0),v},v.resume=function(){return p||(v.isPaused=0,k()),v},v.set=function(t,e){return O[t]=e,q="fps"===O.show,-1!==R(t,u)&&V(),-1!==R(t,d)&&s(F.container,O),v},v.showDuration=function(){return v.set("show","ms"),v},v.showFps=function(){return v.set("show","fps"),v},v.toggle=function(){return v.set("show",q?"ms":"fps"),v},v.hide=function(){return v.pause(),F.container.style.display="none",v},v.show=function(){return v.resume(),F.container.style.display="block",v},v.destroy=function(){v.pause(),U(),v.tick=v.tickStart=function(){}},V(),k()}var n,o=t.performance;n=o&&(o.now||o.webkitNow)?o[o.now?"now":"webkitNow"].bind(o):function(){return+new Date};for(var a=t.cancelAnimationFrame||t.cancelRequestAnimationFrame,i=t.requestAnimationFrame,h=0,l=0,p=(o=["moz","webkit","o"]).length;l<p&&!a;++l)i=(a=t[o[l]+"CancelAnimationFrame"]||t[o[l]+"CancelRequestAnimationFrame"])&&t[o[l]+"RequestAnimationFrame"];a||(i=function(e){var o=n(),a=Math.max(0,16-(o-h));return h=o+a,t.setTimeout((function(){e(o+a)}),a)},a=function(t){clearTimeout(t)});var c="string"===H(document.createElement("div").textContent)?"textContent":"innerText";D.extend=I,window.FPSMeter=D,D.defaults={interval:100,smoothing:10,show:"fps",toggleOn:"click",decimals:1,maxFps:60,threshold:100,position:"absolute",zIndex:10,left:"5px",top:"5px",right:"auto",bottom:"auto",margin:"0 0 0 0",theme:"dark",heat:0,graph:0,history:20};var u=["toggleOn","theme","heat","graph","history"],d="position zIndex left top right bottom margin".split(" ")}(window),function(t,e){e.theme={};var n=e.theme.base={heatmaps:[],container:{heatOn:null,heatmap:null,padding:"5px",minWidth:"95px",height:"30px",lineHeight:"30px",textAlign:"right",textShadow:"none"},count:{heatOn:null,heatmap:null,position:"absolute",top:0,right:0,padding:"5px 10px",height:"30px",fontSize:"24px",fontFamily:"Consolas, Andale Mono, monospace",zIndex:2},legend:{heatOn:null,heatmap:null,position:"absolute",top:0,left:0,padding:"5px 10px",height:"30px",fontSize:"12px",lineHeight:"32px",fontFamily:"sans-serif",textAlign:"left",zIndex:2},graph:{heatOn:null,heatmap:null,position:"relative",boxSizing:"padding-box",MozBoxSizing:"padding-box",height:"100%",zIndex:1},column:{width:4,spacing:1,heatOn:null,heatmap:null}};e.theme.dark=e.extend({},n,{heatmaps:[{saturation:.8,lightness:.8}],container:{background:"#222",color:"#fff",border:"1px solid #1a1a1a",textShadow:"1px 1px 0 #222"},count:{heatOn:"color"},column:{background:"#3f3f3f"}}),e.theme.light=e.extend({},n,{heatmaps:[{saturation:.5,lightness:.5}],container:{color:"#666",background:"#fff",textShadow:"1px 1px 0 rgba(255,255,255,.5), -1px -1px 0 rgba(255,255,255,.5)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},count:{heatOn:"color"},column:{background:"#eaeaea"}}),e.theme.colorful=e.extend({},n,{heatmaps:[{saturation:.5,lightness:.6}],container:{heatOn:"backgroundColor",background:"#888",color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.2)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},column:{background:"#777",backgroundColor:"rgba(0,0,0,.2)"}}),e.theme.transparent=e.extend({},n,{heatmaps:[{saturation:.8,lightness:.5}],container:{padding:0,color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.5)"},count:{padding:"0 5px",height:"40px",lineHeight:"40px"},legend:{padding:"0 5px",height:"40px",lineHeight:"42px"},graph:{height:"40px"},column:{width:5,background:"#999",heatOn:"backgroundColor",opacity:.5}})}(window,FPSMeter));var Fps=pc.createScript("fps");Fps.prototype.initialize=function(){this.fps=new FPSMeter({heat:!0,graph:!0,left:"10px",top:"auto",right:"auto",bottom:"10px"})},Fps.prototype.update=function(t){this.fps.tick()};var UiManager=pc.createScript("uiManager");UiManager.attributes.add("stageText",{type:"entity"}),UiManager.attributes.add("coinText",{type:"entity"}),UiManager.attributes.add("deathScreen",{type:"entity"}),UiManager.attributes.add("pauseMenu",{type:"entity"}),UiManager.attributes.add("shopMenu",{type:"entity"}),UiManager.attributes.add("keyboardText1",{type:"entity"}),UiManager.attributes.add("keyboardText2",{type:"entity"}),UiManager.attributes.add("keyboardText3",{type:"entity"}),UiManager.prototype.initialize=function(){this.onUI=!1,this.firstClick=!1,this.frame=0,pc.platform.touch&&(this.keyboardText1.enabled=!1,this.keyboardText2.enabled=!1,this.keyboardText3.enabled=!1),this.app.root.on("stageUpdate",this._onStageUpdate,this),this.app.root.on("coinUpdate",this._onCoinUpdate,this),this.app.root.on("death",this._onDeath,this),this.app.root.on("respawn",this._onRespawn,this),this.app.root.on("pause",this._onPause,this),this.app.root.on("shop",this._onShop,this),this.app.root.on("rebirth",this._onRebirth,this),this.app.root.on("clearData",this._onClearData,this)},UiManager.prototype.postUpdate=function(){pc.platform.touch||(!(this.frame>10&&!this.onUI&&this.firstClick)||pc.Mouse.isPointerLocked()||this.pauseMenu.enabled||this.shopMenu.enabled||this.deathScreen.enabled||(this.frame=0,this._onPause()),this.frame>10&&this.app.keyboard.wasPressed(pc.KEY_M)&&!this.pauseMenu.enabled&&!this.shopMenu.enabled&&!this.deathScreen.enabled&&(this.frame=0,this._onShop()),this.frame+=1)},UiManager.prototype._onStageUpdate=function(e){this.stageText.element.text=e+1},UiManager.prototype._onCoinUpdate=function(e){this.coinText.element.text=e},UiManager.prototype._onDeath=function(){this.pauseMenu.enabled&&(this.pauseMenu.enabled=!1),this.shopMenu.enabled&&(this.shopMenu.enabled=!1),this.frame=0,this.onUI=!0,this.entity.sound.play("Death"),this.toggleMouse(!0),this.deathScreen.enabled=!0},UiManager.prototype._onRespawn=function(){this.frame=0,this.onUI=!1,this.toggleMouse(!1),this.deathScreen.enabled=!1},UiManager.prototype._onPause=function(){if(this.pauseMenu.enabled)return this.frame=0,this.pauseMenu.enabled=!1,void this.toggle(!1);if(this.onUI)return;this.toggle(!0),this.pauseMenu.enabled=!0;let e=this.pauseMenu.children[0].children[0];e.enabled=!1,setTimeout((()=>e.enabled=!0),1100)},UiManager.prototype._onShop=function(){if(this.shopMenu.enabled)return this.frame=0,this.toggle(!1),void(this.shopMenu.enabled=!1);if(this.onUI)return;this.toggle(!0),this.shopMenu.enabled=!0;let e=this.shopMenu.children[0].children[0];e.enabled=!1,setTimeout((()=>e.enabled=!0),1100)},UiManager.prototype._onRebirth=function(){let e=parseInt(SaveSystem.getItem("totalCoin"));e+=this.app.root.coin,window.localStorage.clear(),SaveSystem.setItem("totalCoin",e),window.location.reload()},UiManager.prototype._onClearData=function(){this.app.root.fire("finish"),window.localStorage.clear(),window.location.reload()},UiManager.prototype.toggle=function(e){this.toggleMouse(e),this.onUI=e,this.app.root.fire(e?"gamePause":"gameResume")},UiManager.prototype.toggleMouse=function(e){pc.platform.touch||(e?this.app.mouse.disablePointerLock():this.app.mouse.enablePointerLock())};var Button=pc.createScript("button");Button.attributes.add("event",{type:"string"}),Button.attributes.add("tween",{type:"boolean"}),Button.prototype.initialize=function(){if(this.tween){let t=this.entity.getLocalPosition();this.entity.tween(this.entity.getLocalPosition()).to({x:t.x,y:t.y+10,z:t.z},1,pc.SineInOut).loop(!0).yoyo(!0).start(),this.entity.tween(this.entity.getLocalScale()).to(new pc.Vec3(1.1,1.1,1.1),1,pc.SineInOut).loop(!0).yoyo(!0).start()}this.entity.button.on("click",(function(t){if("death"!=this.event)this.app.root.fire(this.event);else{this.app.root.findByName("Player").script.playerDeathController._onDeath()}}),this)};var Coin=pc.createScript("coin");Coin.prototype.initialize=function(){if(this.coinID=this.entity.parent.children.indexOf(this.entity),null!=SaveSystem.getItem("coins")&&"true"==JSON.parse(SaveSystem.getItem("coins"))[this.coinID])return void(this.entity.enabled=!1);this.collected=!1;const t=this.entity.getPosition().clone(),i=t.clone().sub(new pc.Vec3(0,10,0)),e=this.app.systems.rigidbody.raycastFirst(t,i);null==e&&console.log(this.entity),this.entity.setPosition(new pc.Vec3(e.point.x,e.point.y+1,e.point.z));let n=this.entity.getLocalPosition();this.entity.tween(this.entity.getLocalPosition()).to(new pc.Vec3(n.x,n.y+.25,n.z),1,pc.SineInOut).loop(!0).yoyo(!0).start(),this.entity.collision.on("triggerenter",(()=>{if(this.collected)return;this.collected=!0,this.entity.sound.play("Collect"),null==this.app.root.coin&&(this.app.root.coin=0),this.app.root.coin+=1,this.app.root.fire("coinUpdate",this.app.root.coin),this.entity.tween(this.entity.getLocalScale()).to(new pc.Vec3(0,0,0),.2,pc.SineInOut).start(),setTimeout((()=>{this.entity.destroy()}),1e3);let t=JSON.parse(SaveSystem.getItem("coins"));t[this.coinID]="true",SaveSystem.setItem("coins",JSON.stringify(t))}),this)},Coin.prototype.update=function(t){this.entity.children[0].rotate(0,50*t,0)};var SetStages=pc.createScript("setStages");SetStages.prototype.initialize=function(){let t=this.entity.children,e=this.app.assets.find("SFX_New_Stage.wav");for(var s=0;s<t.length;s++)t[s].sound.slot("Slot 1").asset=e};var Timer=pc.createScript("timer");Timer.prototype.initialize=function(){this.elapsedTime=SaveSystem.getItem("elapsedTime"),null==this.elapsedTime?(this.elapsedTime=0,SaveSystem.setItem("elapsedTime",this.elapsedTime)):this.elapsedTime=parseInt(SaveSystem.getItem("elapsedTime")),this._timer=!0,this._finish=!1,this.app.root.on("finish",(()=>{this._finish=!0,this._timer=!1})),this.app.root.on("gamePause",(()=>{this._finish||(this._timer=!1)}),this),this.app.root.on("gameResume",(()=>{this._finish||(this._timer=!0)}),this)},Timer.prototype.update=function(e){if(this._timer){this.elapsedTime+=1*e;var i=Math.floor(this.elapsedTime%60),t=Math.floor(this.elapsedTime/60%60),s=Math.floor(this.elapsedTime/3600),m="";s>0&&(m+=s+"h "),t>0&&(m+=t+"m "),i>0&&(m+=i+"s"),""!==m&&(this.entity.element.text=m),SaveSystem.setItem("elapsedTime",parseInt(this.elapsedTime))}};var SaveSystem={_isLocalStorageSupported:function(){var t=!1;null==this.dataStore&&(this.dataStore={});try{window.localStorage,t=!0}catch(e){t=!1}return t},setItem:function(t,e){this._isLocalStorageSupported()?window.localStorage.setItem(t,e):this.dataStore[t]=e},getItem:function(t){return this._isLocalStorageSupported()?window.localStorage.getItem(t):this.dataStore[t]}};var SaveManager=pc.createScript("saveManager");SaveManager.prototype.initialize=function(){if(null==SaveSystem.getItem("totalCoin")&&SaveSystem.setItem("totalCoin",0),null==SaveSystem.getItem("coins")?(SaveSystem.setItem("coins",JSON.stringify({})),this.app.root.coin=parseInt(SaveSystem.getItem("totalCoin")),this.app.root.fire("coinUpdate",this.app.root.coin)):(this.app.root.coin=Object.values(JSON.parse(SaveSystem.getItem("coins"))).length+parseInt(SaveSystem.getItem("totalCoin")),this.app.root.fire("coinUpdate",this.app.root.coin)),null==SaveSystem.getItem("stage"))SaveSystem.setItem("stage",JSON.stringify({}));else{let t=Object.values(JSON.parse(SaveSystem.getItem("stage")));this.app.root.stage=t.length-1,this.app.root.fire("stageUpdate",this.app.root.stage)}};var PercentageController=pc.createScript("percentageController");PercentageController.attributes.add("stagePercentText",{type:"entity"}),PercentageController.attributes.add("percentArrow",{type:"entity"}),PercentageController.prototype.initialize=function(){this.app.root.on("stageUpdate",this._updatePercentage,this)},PercentageController.prototype._updatePercentage=function(e){this.stagePercentText.element.text=e+1+"%";let t=7.2*(e+1)-360;this.percentArrow.tween(this.percentArrow.getLocalPosition()).to(new pc.Vec3(t,-45,0),1,pc.SineOut).start()};var TextLookat=pc.createScript("textLookat");TextLookat.prototype.initialize=function(){this._target=this.app.root.findByName("Player"),this.entity.tween(this.entity.getLocalPosition()).to({x:this.entity.getLocalPosition().x,y:this.entity.getLocalPosition().y+.5,z:this.entity.getLocalPosition().z},1,pc.CubicInOut).loop(!0).yoyo(!0).start()},TextLookat.prototype.update=function(t){let i=new pc.Vec3(this._target.getPosition().x,this.entity.getPosition().y,this._target.getPosition().z);this.entity.lookAt(i)};var Trigger=pc.createScript("trigger");Trigger.attributes.add("event",{type:"string"}),Trigger.prototype.initialize=function(){this.entity.collision.on("triggerenter",this._onTriggerEnter,this)},Trigger.prototype._onTriggerEnter=function(t){t.tags.has("player")&&this.app.root.fire(this.event)};var ShopButton=pc.createScript("shopButton");ShopButton.attributes.add("thumbnail",{type:"entity"}),ShopButton.attributes.add("priceText",{type:"entity"}),ShopButton.prototype.initialize=function(){this.texture=null},ShopButton.prototype.setItem=function(t){this.texture=t.texture,this.thumbnail.element.texture=t.thumbnail.resource,this.priceText.element.text=t.price};var ShopManager=pc.createScript("shopManager");ShopManager.attributes.add("shopItemTemplate",{type:"asset",assetType:"template"}),ShopManager.attributes.add("items",{type:"json",schema:[{name:"texture",type:"asset",assetType:"texture"},{name:"thumbnail",type:"asset",assetType:"texture"},{name:"price",type:"number"},{name:"adCount",type:"number"}],array:!0}),ShopManager.prototype.initialize=function(){this.items.forEach((e=>{let t=this.shopItemTemplate.resource.instantiate();t.script.shopButton.setItem(e),this.entity.addChild(t)}))};var PlayerPositionsSaver=pc.createScript("playerPositionsSaver");PlayerPositionsSaver.attributes.add("bodyEntity",{type:"entity"}),PlayerPositionsSaver.prototype.initialize=function(){this.isAlive=1,this._positions=[],this.positionSaverInterval=setInterval((()=>{const t=this.entity.getLocalPosition(),i=this._getYaw(this.bodyEntity.getLocalRotation()),e=this.bodyEntity.anim.findParameter("animIndex").value;this._positions.push([this._getFrontOfNumber(t.x),this._getFrontOfNumber(t.y),this._getFrontOfNumber(t.z),this._getFrontOfNumber(i,!0),this.isAlive,e,this.app.root.stage])}),125),this.app.root.on("death",this._onDeath,this),this.app.root.on("respawn",this._onRespawn,this),this.once("destroy",(()=>{this.app.root.off("death",this._onDeath,this),this.app.root.off("respawn",this._onRespawn,this),clearInterval(this.positionSaverInterval)}),this)},PlayerPositionsSaver.prototype.update=function(t){this.app.keyboard.wasPressed(pc.KEY_H)&&console.log(JSON.stringify(this._positions))},PlayerPositionsSaver.prototype._getYaw=function(t){let i=new pc.Vec3;return t.transformVector(pc.Vec3.FORWARD,i),Math.atan2(-i.x,-i.z)*pc.math.RAD_TO_DEG},PlayerPositionsSaver.prototype._onDeath=function(){this.isAlive=0},PlayerPositionsSaver.prototype._onRespawn=function(){this.isAlive=1},PlayerPositionsSaver.prototype._getFrontOfNumber=function(t,i=!1){let e=t.toString(),o=e.indexOf(".");if(-1===o)return parseFloat(i?e:e+".00");if(i)return parseFloat(e.substr(0,o));{let t=e.substr(o+1,2);return parseFloat(e.substr(0,o+1)+t)}};var BotAi=pc.createScript("botAi");BotAi.attributes.add("aiTemplate",{type:"asset",assetType:"template"}),BotAi.attributes.add("bodyEntity",{type:"entity"}),BotAi.attributes.add("nicknameText",{type:"entity"}),BotAi.attributes.add("moveSpeed",{type:"number"}),BotAi.attributes.add("rotateSpeed",{type:"number"}),BotAi.prototype.initialize=function(){this._isInitialized=!1,this.nicknameText.element.text=Utils.getRandomNickname();const t=Object.keys(BotSaves.saves);if(null==pc.app.botIDs){pc.app.botIDs={};for(let i=0;i<t.length;i++)pc.app.botIDs[i]=!1}for(this.botID=0;1==pc.app.botIDs[this.botID];)this.botID=t[Math.floor(pc.math.random(0,t.length))];pc.app.botIDs[this.botID]=!0,this._botSave=JSON.parse(BotSaves.saves[this.botID]);let i=0;this._lastAliveState=this._botSave[i][4],this._lastAiPos=new pc.Vec3(this._botSave[i][0],this._botSave[i][1],this._botSave[i][2]),this.entity.setPosition(this._botSave[i][0],this._botSave[i][1],this._botSave[i][2]),this._getSave(i),this._getSaveInterval=setInterval((()=>{if(this._getSave(i),i+=1,i==this._botSave.length){pc.app.botIDs[this.botID]=!1,clearInterval(this._getSaveInterval),this.entity.destroy();let t=this.aiTemplate.resource.instantiate();this.app.root.addChild(t)}}),125),this.once("destroy",(()=>{clearInterval(this._getSaveInterval)}),this),this._isInitialized=!0},BotAi.prototype.update=function(t){this._isInitialized&&(this._setRotation(t),this._setPosition(t))},BotAi.prototype._setRotation=function(t){const i=this.bodyEntity.getLocalRotation(),e=i.slerp(i,this._rotationFromSave,this.rotateSpeed*t);this.bodyEntity.setLocalRotation(e)},BotAi.prototype._setPosition=function(t){this._lastAiPos.lerp(this.entity.getPosition(),this._positionFromSave,this.moveSpeed*t),this.entity.setPosition(this._lastAiPos)},BotAi.prototype._setAliveState=function(){this._lastAliveState!=this._isAliveFromSave&&1==this._isAliveFromSave&&(this._lastAiPos=this._positionFromSave,this.entity.setPosition(this._lastAiPos)),this.bodyEntity.enabled=this._isAliveFromSave,this.nicknameText.enabled=this._isAliveFromSave,this._lastAliveState=this._isAliveFromSave},BotAi.prototype._setAnimation=function(){this.bodyEntity.anim.setInteger("animIndex",this._animIndexFromSave)},BotAi.prototype._getSave=function(t){this._positionFromSave=new pc.Vec3(this._botSave[t][0],this._botSave[t][1],this._botSave[t][2]),this._rotationFromSave=(new pc.Quat).setFromEulerAngles(0,this._botSave[t][3],0),this._isAliveFromSave=1==this._botSave[t][4],this._animIndexFromSave=this._botSave[t][5],this._stageFromSave=this._botSave[t][6],this._setAliveState(),this._setAnimation()};var LookToCamera=pc.createScript("lookToCamera");LookToCamera.attributes.add("angle",{type:"vec3",default:[180,0,180]}),LookToCamera.prototype.initialize=function(){this.camera=this.app.root.findByName("Camera")},LookToCamera.prototype.postUpdate=function(a){null!=this.camera&&null!=this.camera?(this.entity.lookAt(this.camera.getPosition().clone()),this.entity.rotateLocal(this.angle.x,this.angle.y,this.angle.z)):this.camera=this.app.root.findByName("Camera")};var Utils={getRandomNickname:function(){let t=["Beautiful","Big","Smart","Fast","Cute","Happy","Bright","Quiet","Colorful","Healthy"],a=["Table","Book","Computer","Cat","Sky","Sea","Flower","Friend","City","Rose","Eda","Amet","Cuvan"];return t[Math.floor(Math.random()*t.length)]+a[Math.floor(Math.random()*a.length)]}};var LookToSomething=pc.createScript("lookToSomething");LookToSomething.attributes.add("angle",{type:"vec3",default:[180,0,180]}),LookToSomething.attributes.add("lookToEntity",{type:"entity"}),LookToSomething.prototype.postUpdate=function(t){this.entity.lookAt(this.lookToEntity.getPosition().clone()),this.entity.rotateLocal(this.angle.x,this.angle.y,this.angle.z)};